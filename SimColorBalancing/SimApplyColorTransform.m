function outImages = SimApplyColorTransform(M,inImages)% outImages = SimApplyColorTransform(M,inImages)% % Apply a color space transformation to the input image% planes (3D matrix).  Matrix is applied from the left,% and we think of each pixel as a column vector when% we apply it.%% 12/18/98  dhb  Wrote it.% 02/09/07  dhb  Call through reshape routines.% Copyright (c) 1999 David Brainard and Philippe Longere.   All rights reserved.% Convert to apply transform[inImages,height,width,numberPlanesIn] = SimImageToColumns(inImages);numberPlanesOut = size(M,1); if (size(M,2) ~= numberPlanesIn)	error('Size of M does not match number of image planes');end% Apply transformoutImages = M*inImages;% Convert output formatoutImages = SimColumnsToImage(outImages,height,width,numberPlanesOut);