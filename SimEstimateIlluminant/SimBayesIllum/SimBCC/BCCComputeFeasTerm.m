function T_feas = BCCComputeFeasTerm(A_est,y,u_nk,K_nk)% T_feas = BCCComputeFeasTerm(A_est,y,u_nk,K_nk)%% Compute the feasibility term.  This refers to our% derivation for the marginal posterior in the% Normal case.%% The normalizing constant is neglected.%% 11/7/94		dhb		Added this comment.% Expand noise out for the whole enchiladay = y(:);[N_y,null] = size(y);[N_r,null] = size(u_nk);N_expand = N_y/N_r;u_n = BCCExpandMean(u_nk,N_expand);K_n = BCCExpandCov(K_nk,N_expand);% Compute feasibilitydev = y - u_n - A_est*(A_est\y);T_feas = exp(-0.5*(dev'*inv(K_n)*dev));