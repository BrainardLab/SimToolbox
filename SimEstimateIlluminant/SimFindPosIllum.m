function [x] = SimFindPosIllum(illum,B_illum)% [x] = SimFindPosIllum(illum,B_illum)%% Find the best fit the the illuminant within the passed linear model,% subject to the constraint that the weights be positive.%% 4/16/99  dhb  Wrote it.% 2/10/07  dhb  Updated for Optimization Toolbox 2.0.% Copyright (c) 1999 David Brainard and Philippe Longere.   All rights reserved.% Find initial guess through regression.x0 = B_illum\illum;% Use MATLAB's lsqlinoptions = optimset;options = optimset(options,'LargeScale','off');x = lsqlin(B_illum,illum,-B_illum,zeros(size(illum)),[],[],[],[],x0,options);