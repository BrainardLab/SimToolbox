function []= HypDarkSubstract(suffix,darksuffix,directory1,directory2,S_hyperspectral,height,width,starth,startw,newheight,newwidth)% HypDarkSubstract(suffix,darksuffix,directory1,directory2,S_hyperspectral,height,width,starth,startw,newheight,newwidth)% makes the dark substraction, and eventually some cropping on the images% Files are assumed to follow the naming pattern : suffixwavelength.dmp% lying in directory1, and put them into directory2% Thus input files are dmp (PixelVision) 16 bits files, and output are% raw 16 bits files written following Intel bit sequence.  %%   05/19/00  pxl  Wrote it  type = 'uint16';originalPlatform = 1;offset=3;nb=0;for (k=SToWls(S_hyperspectral)')  nb = nb+1;  filename = [suffix num2str(k) '.dmp'];  dfilename = [darksuffix num2str(k) '.dmp'];  x = SimReadRawImage([directory1 '/' filename], height, width, type, originalPlatform,offset);  d = SimReadRawImage([directory1 '/' dfilename], height, width, type, originalPlatform,offset);  xx = x-d;  xx(find(xx<0))=0;  xx = xx(starth:starth+newheight-1,startw:startw+newwidth-1);  filename = [suffix num2str(k)];  SimWriteRawImage([directory2 '/' filename],xx,type,originalPlatform);end